# vi:ft=sh

# PROMPT
case ${TERM} in
  xterm*|rxvt*|Eterm|aterm|kterm|gnome*)
  PROMPT_COMMAND='echo -ne "\033]0;${PWD/$HOME/~}\007"'
  ;;
  screen)
  PROMPT_COMMAND='echo -ne "\033_${PWD/$HOME/~}\033\\"'
  ;;
esac

# set a fancy prompt (non-color, unless we know we "want" color)
function git_need_to_push() {
  if pushtime=`git status | grep 'Your branch is ahead' 2> /dev/null  | awk {'print $9'}`; then
    echo "${pushtime} â†‘ "
  fi
}

function parse_git_branch() {
  RSLT=''
  GIT_BRANCH=`__git_ps1`
  if [ "$GIT_BRANCH" ] ; then
    GIT_STATUS=`git status 2> /dev/null | grep 'working directory clean'`
    CLR='2'
    if [ "$GIT_STATUS" ] ; then
      CLR='2'
    else
      CLR='1'
    fi
    RSLT="[01;3${CLR};40m[${GIT_BRANCH} $(git_need_to_push)][0m"
  fi
  echo $RSLT
}

COL=`expr $COLUMNS - 1`
LINE=''
COUNT=0
while test ${COL} -gt $COUNT
do
	let COUNT++
	LINE="${LINE}â”€"
done

export PS1='â”Œ${LINE}[${COL}Dâ”€â”€â”€â”€[01;30m[\u@\h][0mâ”€â”€â”€â”€â”€[01;36m[\t][0mâ”€â”€â”€â”€â”€[01;34m[\W][0mâ”€â”€â”€â”€â”€$(parse_git_branch)â”€â”€â”€
â””â”€> \$ '
